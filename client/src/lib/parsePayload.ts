const testResponse = {
    self: {
        href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/incomplete-orders/385632ad-e032-4e01-9357-8eaa5055165b/',
        id: '385632ad-e032-4e01-9357-8eaa5055165b',
    },
    number: 'QT-20251020-0016763',
    agent: {
        href: 'https://sandbox-bo.i2go.io/api/v3/business-partner-service/business-partners/f31404d9-799d-40fe-abb5-936986fcad81/',
        id: 'f31404d9-799d-40fe-abb5-936986fcad81',
    },
    holder: {
        self: {
            href: 'https://sandbox-bo.i2go.io/api/v3/business-partner-service/business-partners/2593edd6-0465-4119-b685-3afdad63bb5c/',
            id: '2593edd6-0465-4119-b685-3afdad63bb5c',
        },
        number: 'BP-011214',
        title: 'Mr',
        firstName: 'Jess',
        middleName: null,
        lastName: 'Bosco',
        fullName: 'Jess Bosco',
        nickname: '',
        profilePicture: null,
        gender: null,
        dob: '1988-03-06',
        maritalStatus: null,
        occupation: '',
        education: null,
        nationality: null,
        registrationName: '',
        registrationCode: '',
        companyLegalStructure: null,
        companyFoundingDate: null,
        companySize: '',
        category: 'Person',
        company: null,
        group: null,
        correspondenceLanguage: 'en',
        email: 'ayman_test_motor_vehicle_245f3@testing.com',
        emailPrimary: 'ayman_test_motor_vehicle_245f3@testing.com',
        emailCorrespondence: null,
        emailBilling: '',
        emailWork: '',
        emailOther: '',
        phone: '+442071234567',
        phoneMobile: '+442071234567',
        phoneWork: '',
        phoneHome: '',
        phoneFax: '',
        preferredCommunicationChannels: null,
        prefersNoContact: false,
        roles: [
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/business-partner-service/roles/1b6ee4d2-5846-4cd3-8ae5-d2aa0dbc9008/',
                id: '1b6ee4d2-5846-4cd3-8ae5-d2aa0dbc9008',
            },
        ],
        isActive: false,
        addresses: [
            {
                self: {
                    href: 'https://sandbox-bo.i2go.io/api/v3/business-partner-service/addresses/50944255-3b20-45b1-9838-19aee027ba73/',
                    id: '50944255-3b20-45b1-9838-19aee027ba73',
                },
                types: ['DEFAULT'],
                details: {
                    id: 'fc810290-ae07-4836-8d9e-f923fdae6970',
                    line1: 'Siam Paragon',
                    line2: '991 Rama I Road',
                    line3: 'Pathum Wan',
                    postalCode: '10330',
                    unitNo: null,
                    building: null,
                    district: null,
                    city: 'Bangkok',
                    state: 'Bangkok',
                    country: 'TH',
                    fullAddress: 'Siam Paragon, 991 Rama I Road, Pathum Wan, 10330 Bangkok, Bangkok, TH',
                    extraData: {
                        line4: 'Pathum Wan District',
                        latitude: '13.7456',
                        longitude: '100.5347',
                    },
                },
                businessPartner: {
                    href: 'https://sandbox-bo.i2go.io/api/v3/business-partner-service/business-partners/2593edd6-0465-4119-b685-3afdad63bb5c/',
                    id: '2593edd6-0465-4119-b685-3afdad63bb5c',
                },
                isDefault: true,
                links: [
                    {
                        rel: 'business_partners',
                        href: 'https://sandbox-bo.i2go.io/api/v3/business-partner-service/business-partners/',
                    },
                ],
                createdAt: '2025-10-20T12:20:18.959071+02:00',
                updatedAt: '2025-10-20T12:20:18.968162+02:00',
            },
        ],
        incompleteOrders: [
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/incomplete-orders/1aac3bad-72e7-4b26-92c7-0f3549df8e15/',
                id: '1aac3bad-72e7-4b26-92c7-0f3549df8e15',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/incomplete-orders/016a5ab1-5ee5-4479-ad67-f267c4181b0a/',
                id: '016a5ab1-5ee5-4479-ad67-f267c4181b0a',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/incomplete-orders/5590e06b-daee-423c-925c-0c3ba23ab74c/',
                id: '5590e06b-daee-423c-925c-0c3ba23ab74c',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/incomplete-orders/2544c2a9-08e6-4287-a09c-b1fa9fa82998/',
                id: '2544c2a9-08e6-4287-a09c-b1fa9fa82998',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/incomplete-orders/555a7000-b5ef-4de9-8225-d3f0d1497324/',
                id: '555a7000-b5ef-4de9-8225-d3f0d1497324',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/incomplete-orders/d0d2deb5-a241-4d5f-8dce-49ba2a78e805/',
                id: 'd0d2deb5-a241-4d5f-8dce-49ba2a78e805',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/incomplete-orders/7c9074ec-333f-4bf8-81f5-d1c21e19afe0/',
                id: '7c9074ec-333f-4bf8-81f5-d1c21e19afe0',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/incomplete-orders/8e1088a9-3653-424b-9f28-049c1e0ce49b/',
                id: '8e1088a9-3653-424b-9f28-049c1e0ce49b',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/incomplete-orders/aadaa925-bdfb-4314-88bb-6cf55b1d56b2/',
                id: 'aadaa925-bdfb-4314-88bb-6cf55b1d56b2',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/incomplete-orders/385632ad-e032-4e01-9357-8eaa5055165b/',
                id: '385632ad-e032-4e01-9357-8eaa5055165b',
            },
        ],
        policies: [
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/policies/bc658e5c-2172-4a5b-a1d2-6015b8c6b3af/',
                id: 'bc658e5c-2172-4a5b-a1d2-6015b8c6b3af',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/policies/a6486a86-8792-47ba-b018-b2afd8e27446/',
                id: 'a6486a86-8792-47ba-b018-b2afd8e27446',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/policies/7b9aa6dd-8b49-47c8-bf08-ccfd2a92aa88/',
                id: '7b9aa6dd-8b49-47c8-bf08-ccfd2a92aa88',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/policies/7386dde9-34fe-4e65-ae53-f20678dae7b6/',
                id: '7386dde9-34fe-4e65-ae53-f20678dae7b6',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/policies/f0957f3f-3846-434b-a6e2-47b90f6de0d8/',
                id: 'f0957f3f-3846-434b-a6e2-47b90f6de0d8',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/policies/0abb65d5-4f47-4608-a715-2f62aabe91c6/',
                id: '0abb65d5-4f47-4608-a715-2f62aabe91c6',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/policies/b00fd064-74e1-4034-8143-d1b856f1e473/',
                id: 'b00fd064-74e1-4034-8143-d1b856f1e473',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/policies/7b2e9900-f299-436c-855d-1852dfe79237/',
                id: '7b2e9900-f299-436c-855d-1852dfe79237',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/policies/4d4f73f5-766b-44e3-ab71-913c035aabec/',
                id: '4d4f73f5-766b-44e3-ab71-913c035aabec',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/policies/d89881b1-7703-4c0a-94c3-6720f1ae19db/',
                id: 'd89881b1-7703-4c0a-94c3-6720f1ae19db',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/policies/3f056b9c-9ed8-472c-8d56-e8b0b4c8ea19/',
                id: '3f056b9c-9ed8-472c-8d56-e8b0b4c8ea19',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/policies/f6e27fee-b579-4c92-8eee-4b161f48ab3f/',
                id: 'f6e27fee-b579-4c92-8eee-4b161f48ab3f',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/policies/f5191f11-7bc1-4bdb-958a-e2e4420b9a30/',
                id: 'f5191f11-7bc1-4bdb-958a-e2e4420b9a30',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/policies/517d9ed4-0078-4439-9d08-08b4f67a6736/',
                id: '517d9ed4-0078-4439-9d08-08b4f67a6736',
            },
        ],
        activePolicyRelations: [],
        pendingPolicyRelations: [],
        consentManagement: [],
        idType: null,
        idNumber: 'Pedro396',
        idIssueDate: null,
        telematicsEnabled: false,
        duplicateCheckResponse: null,
        extraData: [
            {
                key: 'occupation',
                value: 'Software Engineer',
                key_display: 'Occupation',
                value_display: 'Software Engineer',
            },
            {
                key: 'driver_age_range',
                value: '26_35',
                key_display: 'Driver Age Range',
                value_display: '26-35',
            },
            {
                key: 'driving_experience',
                value: '6_10',
                key_display: 'Driving Experience',
                value_display: '6-10 years',
            },
            {
                key: 'claims_history_past_3_years',
                value: '0',
                key_display: 'Claims History (Past 3 years)',
                value_display: 'No Claims',
            },
            {
                key: 'no_claims_bonus_ncb',
                value: true,
                key_display: 'No Claims Bonus (NCB)',
                value_display: 'Yes, I have NCB',
            },
        ],
        createdAt: '2025-10-16T12:20:06.882777+02:00',
        updatedAt: '2025-10-17T11:30:59.161693+02:00',
        links: [
            {
                rel: 'addresses',
                href: 'https://sandbox-bo.i2go.io/api/v3/business-partner-service/addresses/',
            },
            {
                rel: 'incomplete_orders',
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/incomplete-orders/',
            },
            {
                rel: 'policies',
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/policies/',
            },
            {
                rel: 'policy_relations',
                href: 'https://sandbox-bo.i2go.io/api/v3/business-partner-service/policy-relations/',
            },
            {
                rel: 'agents',
                href: 'https://sandbox-bo.i2go.io/api/v3/business-partner-service/agents/',
            },
        ],
        paperDocumentEnabled: false,
        policyAutoRenewal: true,
        bankAccount: null,
        creator: 'Core Development API',
        owner: null,
        paymentData: {},
        gdprStatus: null,
        attributeValues: [],
    },
    product: {
        href: 'https://sandbox-bo.i2go.io/api/v3/product-service/products/79fc572a-152b-4f02-91b3-ae4742ef37a7/',
        id: '79fc572a-152b-4f02-91b3-ae4742ef37a7',
    },
    productPlan: {
        self: {
            href: 'https://sandbox-bo.i2go.io/api/v3/product-service/plans/2cf2be54-d14e-44d9-8542-27b1f2658dd3/',
            id: '2cf2be54-d14e-44d9-8542-27b1f2658dd3',
        },
        name: '1 Plus',
        slug: 'comprehensive',
        description: '',
        product: {
            href: 'https://sandbox-bo.i2go.io/api/v3/product-service/products/79fc572a-152b-4f02-91b3-ae4742ef37a7/',
            id: '79fc572a-152b-4f02-91b3-ae4742ef37a7',
        },
        coverages: [
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/product-service/product-coverages/2fa59e71-48ff-4f30-b8d6-edd56144df6e/',
                id: '2fa59e71-48ff-4f30-b8d6-edd56144df6e',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/product-service/product-coverages/2ef12b67-4a78-499d-ac28-a04f74302480/',
                id: '2ef12b67-4a78-499d-ac28-a04f74302480',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/product-service/product-coverages/ae8234f8-9c9e-4b34-a416-ad7ae02f7cac/',
                id: 'ae8234f8-9c9e-4b34-a416-ad7ae02f7cac',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/product-service/product-coverages/77dd46c4-3c7b-4012-8a91-c061d3a246e1/',
                id: '77dd46c4-3c7b-4012-8a91-c061d3a246e1',
            },
            {
                href: 'https://sandbox-bo.i2go.io/api/v3/product-service/product-coverages/880e724c-2ac6-47d0-908a-a0b147e9a697/',
                id: '880e724c-2ac6-47d0-908a-a0b147e9a697',
            },
        ],
        isDefault: true,
        attributes: {},
        links: [
            {
                rel: 'products',
                href: 'https://sandbox-bo.i2go.io/api/v3/product-service/products/',
            },
            {
                rel: 'product_attachments',
                href: 'https://sandbox-bo.i2go.io/api/v3/product-service/attachments/',
            },
        ],
        createdAt: '2025-09-11T10:07:33.894350+02:00',
        updatedAt: '2025-10-15T09:39:59.896336+02:00',
    },
    status: 'Quoted',
    lineOfBusiness: 'Motor Vehicle',
    submissionType: '',
    underwriter: '',
    agentCompany: 'tigerlab',
    receivedDate: null,
    approvedForRenewal: false,
    paymentScheme: 'Yearly',
    paymentDay: null,
    classification: null,
    startDate: '2025-12-20',
    endDate: '2026-12-20',
    startDateOverride: null,
    endDateOverride: null,
    followUpDate: null,
    progress: 80,
    netAmount: '15000.00',
    loadingAmount: '1660.00',
    netLoadAmount: '16660.00',
    grossAmount: '16660.00',
    iptAmount: '0.00',
    finalAmount: '16660.00',
    totalPayableAmount: '16900.00',
    proratedAmount: '16900.00',
    adminFee: '240.00',
    commissionAmount: null,
    pricingBreakdown: {
        premiums: {
            yearly: {
                totalPayableAmount: 16900,
            },
            monthly: {
                totalPayableAmount: 1408.3333333333333,
            },
        },
    },
    pricingDeviation: {
        iptAmount: 0.0,
        netAmount: 15000.0,
        finalAmount: 16660.0,
        loadingAmount: 1660.0,
        premiumAmount: 16660.0,
        netLoadAmount: 16660.0,
        proratedAmount: 16900.0,
        pricingBreakdown: {
            premiums: {
                yearly: {
                    totalPayableAmount: 16900,
                },
                monthly: {
                    totalPayableAmount: 1408.3333333333333,
                },
            },
        },
        totalPayableAmount: 16900.0,
    },
    voucherAttributes: null,
    campaignAttributes: null,
    businessPartnerRelations: [],
    policyTerm: 'Yearly',
    recurrenceScheme: 'Yearly',
    policyVersion: {
        href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/versions/efa43fe2-05bb-4957-a40e-b9daafa3897e/',
        id: 'efa43fe2-05bb-4957-a40e-b9daafa3897e',
    },
    items: [
        {
            self: {
                href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/items/c64f5ab1-bc3b-45ee-9891-e506bf18f290/',
                id: 'c64f5ab1-bc3b-45ee-9891-e506bf18f290',
            },
            parent: null,
            riskId: null,
            name: 'Toyota Corolla 1.8 2021 1033',
            slug: 'toyota-corolla-1-8-2021-1033',
            number: null,
            amount: '0.00',
            startDate: null,
            endDate: null,
            details: {},
            attributes: [
                {
                    key: 'car_brand',
                    value: 'Toyota',
                    key_display: 'Car Brand',
                    value_display: 'Toyota',
                },
                {
                    key: 'car_model',
                    value: 'Corolla 1.8',
                    key_display: 'Car Model',
                    value_display: 'Corolla 1.8',
                },
                {
                    key: 'year',
                    value: '2021',
                    key_display: 'Year',
                    value_display: '2021',
                },
                {
                    key: 'transmission',
                    value: 'Automatic',
                    key_display: 'Transmission',
                    value_display: 'Automatic',
                },
                {
                    key: 'license_plate',
                    value: 'ABC1234',
                    key_display: 'License Plate',
                    value_display: 'ABC1234',
                },
                {
                    key: 'chassis_number',
                    value: 'JTMZK33V075012345',
                    key_display: 'Chassis Number',
                    value_display: 'JTMZK33V075012345',
                },
                {
                    key: 'engine_number',
                    value: '2ZR1234567',
                    key_display: 'Engine Number',
                    value_display: '2ZR1234567',
                },
                {
                    key: 'color',
                    value: 'Metallic Silver',
                    key_display: 'Color',
                    value_display: 'Metallic Silver',
                },
                {
                    key: 'usage_type',
                    value: 'Private',
                    key_display: 'Usage Type',
                    value_display: 'Private',
                },
                {
                    key: 'annual_mileage',
                    value: '15000',
                    key_display: 'Annual Mileage',
                    value_display: '15,000 km',
                },
                {
                    key: 'parking_location',
                    value: 'Covered garage at home',
                    key_display: 'Parking Location',
                    value_display: 'Covered garage at home',
                },
                {
                    key: 'vehicle_modifications',
                    value: 'None',
                    key_display: 'Vehicle Modifications',
                    value_display: 'None',
                },
            ],
            declarations: {},
            ratingExchange: {},
            pricingBreakdown: {},
            policyCoverages: [],
            links: [
                {
                    rel: 'policy_versions',
                    href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/versions/',
                },
                {
                    rel: 'policy_coverages',
                    href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/policy-coverages/',
                },
                {
                    rel: 'policies',
                    href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/policies/',
                },
            ],
            isRemoved: false,
            isRated: false,
            createdAt: '2025-10-20T12:20:19.520342+02:00',
            updatedAt: '2025-10-20T12:20:19.520359+02:00',
        },
    ],
    headers: [
        {
            key: 'source',
            value: 'CCI',
            key_display: 'Source',
            value_display: 'CCI',
        },
    ],
    attributes: [
        {
            key: 'deductible_amount',
            value: 5000,
            key_display: 'Deductible Amount',
            value_display: '฿5,000',
        },
        {
            key: 'flood_coverage',
            value: 800,
            key_display: 'Flood Coverage',
            value_display: '+฿800/year',
        },
        {
            key: 'fire_protection',
            value: 600,
            key_display: 'Fire Protection',
            value_display: '+฿600/year',
        },
        {
            key: 'theft_coverage',
            value: 1200,
            key_display: 'Theft Coverage',
            value_display: '+฿1,200/year',
        },
        {
            key: 'personal_accident_driver',
            value: 500,
            key_display: 'Personal Accident for Driver',
            value_display: '+฿500/year',
        },
        {
            key: 'passenger_protection',
            value: 600,
            key_display: 'Passenger Protection',
            value_display: '+฿600/year',
        },
        {
            key: 'windshield_protection',
            value: 400,
            key_display: 'Windshield Protection',
            value_display: '+฿400/year',
        },
    ],
    declarations: {},
    lostStatusReason: null,
    otherLostStatusReasons: null,
    leadType: 'Drop Off',
    leadTypeReason: null,
    leadClassification: 'Hot',
    policy: {
        href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/policies/76513363-037c-4611-9469-4456448b11c1/',
        id: '76513363-037c-4611-9469-4456448b11c1',
    },
    transactionType: 'New Business',
    transactions: [],
    latestVersion: null,
    currentVersion: null,
    rootVersion: {
        href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/versions/efa43fe2-05bb-4957-a40e-b9daafa3897e/',
        id: 'efa43fe2-05bb-4957-a40e-b9daafa3897e',
    },
    rating: {
        '2-plus': {
            yearly: {
                adminFee: 80,
                iptAmount: 0,
                netAmount: 7693,
                finalAmount: 7947,
                loadingAmount: 254,
                premiumAmount: 7947,
                totalPayableAmount: 8027,
            },
            monthly: {
                adminFee: 6.67,
                iptAmount: 0.0,
                netAmount: 641.08,
                finalAmount: 662.25,
                loadingAmount: 21.17,
                premiumAmount: 662.25,
                totalPayableAmount: 668.92,
            },
            coverage: {
                deductible: 3000,
                floodCoverage: true,
                theftProtection: false,
                ownDamageCoverage: null,
                thirdPartyLiability: 364290,
                authorizedRepairShop: true,
            },
        },
        '3-plus': {
            yearly: {
                adminFee: 120,
                iptAmount: 0,
                netAmount: 8282,
                finalAmount: 8539,
                loadingAmount: 257,
                premiumAmount: 8539,
                totalPayableAmount: 8659,
            },
            monthly: {
                adminFee: 10.0,
                iptAmount: 0.0,
                netAmount: 690.17,
                finalAmount: 711.58,
                loadingAmount: 21.42,
                premiumAmount: 711.58,
                totalPayableAmount: 721.58,
            },
            coverage: {
                deductible: 3000,
                floodCoverage: true,
                theftProtection: false,
                ownDamageCoverage: 105473,
                thirdPartyLiability: 588293,
                authorizedRepairShop: true,
            },
        },
        comprehensive: {
            yearly: {
                adminFee: 240,
                iptAmount: 0,
                netAmount: 15000,
                finalAmount: 16660,
                loadingAmount: 1660,
                premiumAmount: 16660,
                totalPayableAmount: 16900,
            },
            monthly: {
                adminFee: 20.0,
                iptAmount: 0.0,
                netAmount: 1250.0,
                finalAmount: 1388.33,
                loadingAmount: 138.33,
                premiumAmount: 1388.33,
                totalPayableAmount: 1408.33,
            },
            coverage: {
                deductible: 0,
                floodCoverage: true,
                theftProtection: true,
                ownDamageCoverage: 600000,
                thirdPartyLiability: 1000000,
                authorizedRepairShop: true,
            },
        },
        'third-party-only': {
            yearly: {
                adminFee: 100,
                iptAmount: 0,
                netAmount: 4789,
                finalAmount: 5067,
                loadingAmount: 278,
                premiumAmount: 5067,
                totalPayableAmount: 5167,
            },
            monthly: {
                adminFee: 8.33,
                iptAmount: 0.0,
                netAmount: 399.08,
                finalAmount: 422.25,
                loadingAmount: 23.17,
                premiumAmount: 422.25,
                totalPayableAmount: 430.58,
            },
            coverage: {
                deductible: 3000,
                floodCoverage: true,
                theftProtection: true,
                ownDamageCoverage: null,
                thirdPartyLiability: 685820,
                authorizedRepairShop: true,
            },
        },
        'third-party-bodily-injury-and-death': {
            yearly: {
                adminFee: 60,
                iptAmount: 0,
                netAmount: 8382,
                finalAmount: 8859,
                loadingAmount: 477,
                premiumAmount: 8859,
                totalPayableAmount: 8919,
            },
            monthly: {
                adminFee: 5.0,
                iptAmount: 0.0,
                netAmount: 698.5,
                finalAmount: 738.25,
                loadingAmount: 39.75,
                premiumAmount: 738.25,
                totalPayableAmount: 743.25,
            },
            coverage: {
                deductible: 1000,
                floodCoverage: true,
                theftProtection: false,
                ownDamageCoverage: null,
                thirdPartyLiability: 881520,
                authorizedRepairShop: true,
            },
        },
    },
    pdfFileUrl: null,
    allowPdfGeneration: false,
    endorsementNote: null,
    fileAttachments: [],
    ratingTask: {},
    links: [
        {
            rel: 'policies',
            href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/policies/',
        },
        {
            rel: 'policy_versions',
            href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/versions/',
        },
        {
            rel: 'business_partners',
            href: 'https://sandbox-bo.i2go.io/api/v3/business-partner-service/business-partners/',
        },
    ],
    createdAt: '2025-10-20T12:20:19.276880+02:00',
    updatedAt: '2025-10-20T12:20:20.442086+02:00',
    contract: {
        href: 'https://sandbox-bo.i2go.io/api/v3/policy-service/contracts/694a9327-32ee-44b6-9598-d0b40cc9bf5f/',
        id: '694a9327-32ee-44b6-9598-d0b40cc9bf5f',
    },
    extraData: null,
    mtaDates: [],
    excludeScheduleNewPolicyEmail: false,
    partnerVersionUuid: null,
    recurringPayableAmount: null,
};

export function parsePayload(quote = testResponse, newPlan?: string) {
    // Extract dates from quote
    const startDate = new Date(quote.startDate);
    const endDate = new Date(quote.endDate);

    // Use new plan if provided, otherwise use existing plan slug
    const coverageType = newPlan || quote.productPlan.slug;

    // Extract deductible from attributes
    const deductibleAttr = quote.attributes.find((attr) => attr.key === 'deductible_amount');
    const deductible = deductibleAttr?.value || 0;

    // Extract additional coverage from attributes
    const additionalCoverage: string[] = [];
    quote.attributes.forEach((attr) => {
        if (attr.key === 'flood_coverage') additionalCoverage.push('flood');
        if (attr.key === 'fire_protection') additionalCoverage.push('fire');
        if (attr.key === 'theft_coverage') additionalCoverage.push('theft');
        if (attr.key === 'personal_accident_driver') additionalCoverage.push('driver-pa');
        if (attr.key === 'passenger_protection') additionalCoverage.push('passenger');
        if (attr.key === 'windshield_protection') additionalCoverage.push('windshield');
    });

    // Extract extra data from holder
    const getExtraDataValue = (key: string) => {
        const item = quote.holder.extraData?.find((data) => data.key === key);
        return item ? { value: item.value, display: item.value_display } : null;
    };

    const occupation = getExtraDataValue('occupation');
    const driverAge = getExtraDataValue('driver_age_range');
    const drivingExperience = getExtraDataValue('driving_experience');
    const claimsHistory = getExtraDataValue('claims_history_past_3_years');
    const hasNCB = getExtraDataValue('no_claims_bonus_ncb');

    const payload = {
        product: 'motor-vehicle',
        plan: coverageType,
        effectiveDate: startDate.toISOString().split('T')[0],
        end_date: endDate.toISOString().split('T')[0],
        policy_attributes: [
            {
                key: 'deductible_amount',
                key_display: 'Deductible Amount',
                value: deductible,
                value_display: `฿${deductible.toLocaleString()}`,
            },
            additionalCoverage?.includes('flood') && {
                key: 'flood_coverage',
                key_display: 'Flood Coverage',
                value: 800,
                value_display: '+฿800/year',
            },
            additionalCoverage?.includes('fire') && {
                key: 'fire_protection',
                key_display: 'Fire Protection',
                value: 600,
                value_display: '+฿600/year',
            },
            additionalCoverage?.includes('theft') && {
                key: 'theft_coverage',
                key_display: 'Theft Coverage',
                value: 1200,
                value_display: '+฿1,200/year',
            },
            additionalCoverage?.includes('driver-pa') && {
                key: 'personal_accident_driver',
                key_display: 'Personal Accident for Driver',
                value: 500,
                value_display: '+฿500/year',
            },
            additionalCoverage?.includes('passenger') && {
                key: 'passenger_protection',
                key_display: 'Passenger Protection',
                value: 600,
                value_display: '+฿600/year',
            },
            additionalCoverage?.includes('windshield') && {
                key: 'windshield_protection',
                key_display: 'Windshield Protection',
                value: 400,
                value_display: '+฿400/year',
            },
        ],
        policy_headers: [
            {
                key: 'source',
                value: 'CCI',
                key_display: 'Source',
                value_display: 'CCI',
            },
        ],
        progress: quote.progress,
        policy_term: quote.policyTerm,
        policyHolder: {
            category: quote.holder.category,
            firstName: quote.holder.firstName,
            lastName: quote.holder.lastName,
            email: quote.holder.email,
            phoneMobile: quote.holder.phoneMobile,
            title: quote.holder.title,
            dob: quote.holder.dob,
            gender: quote.holder.gender || 'Male',
            idNumber: quote.holder.idNumber || '',
            extraData: [
                occupation && {
                    key: 'occupation',
                    key_display: 'Occupation',
                    value: occupation.value,
                    value_display: occupation.display,
                },
                driverAge && {
                    key: 'driver_age_range',
                    key_display: 'Driver Age Range',
                    value: driverAge.value,
                    value_display: driverAge.display,
                },
                drivingExperience && {
                    key: 'driving_experience',
                    key_display: 'Driving Experience',
                    value: drivingExperience.value,
                    value_display: drivingExperience.display,
                },
                claimsHistory && {
                    key: 'claims_history_past_3_years',
                    key_display: 'Claims History (Past 3 years)',
                    value: claimsHistory.value,
                    value_display: claimsHistory.display,
                },
                hasNCB && {
                    key: 'no_claims_bonus_ncb',
                    key_display: 'No Claims Bonus (NCB)',
                    value: hasNCB.value,
                    value_display: hasNCB.display,
                },
            ].filter(Boolean),
            addresses: quote.holder.addresses.map((addr) => ({
                addressType: addr.types[0] || 'DEFAULT',
                line1: addr.details.line1,
                city: addr.details.city,
                state: addr.details.state,
                postalCode: addr.details.postalCode,
                country: addr.details.country,
            })),
        },
        additionalPartners: [],
        insuredItems: quote.items.map((item) => ({
            name: item.name,
            slug: item.slug,
            attributes: item.attributes.map((attr) => ({
                key: attr.key,
                key_display: attr.key_display,
                value: attr.value,
                value_display: attr.value_display,
            })),
            value: parseFloat(item.amount) || 0,
        })),
        coverages: [
            {
                coverageType: "comprehensive",
                premium: 100,
                deductible: deductible,
            },
        ],
        skipRating: false,
        checkBusinessRules: false,
        saveToDB: true,
        activatePolicy: false,
    };

    return payload;
}

// Export testResponse for testing purposes
export { testResponse };
